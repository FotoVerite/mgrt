#!/usr/bin/env node
var program = require('commander'),
    Mgrt = require('../lib/mgrt'),
    DEFAULT_PATH = 'migrations';

program
	.version(require('../package').version);

var migrate = function(direction) {
	return function(context, options) {
		var path = context.path || DEFAULT_PATH;

		var env = {
			path: path
		}

		var mgrt = new Mgrt(env);
		mgrt.run(direction);
	}
}

program
	.command('up')
	.option('-p, --path <path>', 'Path to migrations base directory')
	.description('Apply pending migrations')
	.action(migrate('up'));

program
	.command('down')
	.option('-p, --path <path>', 'Path to migrations base directory')
	.description('Rollback applied migrations')
	.action(migrate('down'));

program.parse(process.argv);
